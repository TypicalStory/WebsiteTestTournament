<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="i18n.js" type="module"></script>
  <title>Sign Up — LifeLine</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f17; --muted:#8aa0b4; --text:#e6eef6;
      --brand:#5ac8fa; --brand-2:#7df7d1; --line:#1f2a3a;
      --shadow:0 10px 30px rgba(0,0,0,.35); --radius:16px;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b0f17 0%, #0c1322 100%);color:var(--text);font-family:Inter,sans-serif;min-height:100vh;display:flex;flex-direction:column}
    a{color:inherit;text-decoration:none}

    /* Nav */
    nav{background:rgba(11,15,23,.6);backdrop-filter:saturate(140%) blur(12px);border-bottom:1px solid var(--line)}
    .nav-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:14px 20px}
    .brand{display:flex;align-items:center;gap:8px;font-weight:800}
    .logo{width:28px;height:28px;border-radius:6px;background:linear-gradient(135deg,var(--brand),var(--brand-2))}
    .nav-right{display:flex;gap:10px;align-items:center}
    .nav-right a{color:#cfe7ff;font-weight:600}

    /* Layout */
    .container{width:min(560px,92%);margin:auto;padding:40px 0}
    h1{margin:0 0 10px;text-align:center}
    p.lead{text-align:center;color:var(--muted);margin:0 0 20px}

    .btn{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:14px 16px;margin:8px 0;border-radius:12px;font-weight:600;border:1px solid #1b2f49;background:#0e1727;cursor:pointer}
    .btn img{width:20px;height:20px}
    .btn.google{border-color:#4285f4}
    .btn.apple{border-color:#fff}
    .btn.primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#0b0f17;border:none}
    .btn.link{background:transparent;border:none;color:#5ac8fa;text-decoration:underline;width:auto;padding:4px 8px;margin:0}

    .card{border:1px solid var(--line);background:linear-gradient(180deg,#0d1524,#0b1321);border-radius:16px;box-shadow:var(--shadow);padding:20px}
    .sep{display:flex;align-items:center;gap:10px;color:var(--muted);margin:16px 0}
    .sep::before,.sep::after{content:"";height:1px;background:#1b2f49;flex:1}

    /* Form */
    form{margin-top:8px}
    .field{margin-bottom:16px}
    label{display:block;margin-bottom:6px;font-weight:600}
    input{width:100%;padding:12px 14px;border-radius:10px;border:1px solid #1b2f49;background:#0e1727;color:var(--text);outline:none}
    input:focus{border-color:#24507e;box-shadow:0 0 0 3px rgba(90,200,250,.15)}
    .hint{font-size:12px;color:var(--muted);margin-top:6px}
    .error{color:#ef4444;font-size:13px;margin-top:8px;display:none}

    .grid-otp{display:grid;grid-template-columns:repeat(6,1fr);gap:8px}
    .grid-otp input{padding:12px 0;text-align:center;font-size:18px}

    .note{margin-top:16px;text-align:center;color:var(--muted)}
    footer{margin-top:auto;text-align:center;color:var(--muted);padding:20px 0;border-top:1px solid var(--line);font-size:14px}
  </style>
</head>
<body>
  <!-- Nav -->
  <nav>
  <div class="nav-inner">
    <a href="about.htm" class="brand">  <!-- was about.htm -->
      <span class="logo"></span><span>LifeLine</span>
    </a>
    <div class="nav-right">
      <a href="login.htm">Log in</a>
      <a href="signUp.htm" aria-current="page">Sign Up</a>
    </div>
  </div>
</nav>


  <!-- Main -->
  <main class="container">
    <h1>Create your LifeLine account</h1>
    <p class="lead">Choose Google or Apple, or use your email (verify first, then set a password).</p>

    <div class="card">
      <!-- OAuth -->
      <button class="btn google" id="btnGoogle">
        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="" />
        Sign up with Google
      </button>
      <button class="btn apple" id="btnApple">
        <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg" alt="" />
        Sign up with Apple
      </button>

      <div class="sep"><span>or</span></div>

      <!-- Step 1: Email -->
      <section id="stepEmail">
        <form id="emailForm" novalidate>
          <div class="field">
            <label for="email">Email</label>
            <input type="email" id="email" required placeholder="you@example.com" autocomplete="email">
            <div class="hint">We’ll send a 6-digit code to verify your email.</div>
          </div>
          <button type="submit" class="btn primary">Send verification code</button>
          <div id="emailError" class="error">Please enter a valid email.</div>
        </form>
      </section>

      <!-- Step 2: Verify code + create password -->
      <section id="stepVerify" hidden>
        <form id="verifyForm" novalidate>
          <div class="field">
            <label for="code1">Verification code</label>
            <div class="grid-otp">
              <input inputmode="numeric" maxlength="1" id="code1">
              <input inputmode="numeric" maxlength="1" id="code2">
              <input inputmode="numeric" maxlength="1" id="code3">
              <input inputmode="numeric" maxlength="1" id="code4">
              <input inputmode="numeric" maxlength="1" id="code5">
              <input inputmode="numeric" maxlength="1" id="code6">
            </div>
            <div class="hint">Didn’t get it? <button class="btn link" type="button" id="resend">Resend</button></div>
          </div>

          <div class="field">
            <label for="password">Create password</label>
            <input type="password" id="password" minlength="6" required placeholder="At least 6 characters" autocomplete="new-password">
          </div>
          <div class="field">
            <label for="confirm">Confirm password</label>
            <input type="password" id="confirm" minlength="6" required placeholder="Repeat password" autocomplete="new-password">
          </div>

          <button type="submit" class="btn primary">Create account</button>
          <div id="verifyError" class="error">Wrong code or passwords don’t match.</div>
        </form>
      </section>

      <!-- Back to login -->
      <div class="note" style="margin-top:12px">
        Already have an account? <a href="login.htm">Back to Login</a>
      </div>
    </div>
  </main>

  <footer>
    © <span id="year"></span> LifeLine. All rights reserved.
  </footer>

<script type="module">
  // Firebase SDKs
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import {
    getAuth,
    sendSignInLinkToEmail,
    GoogleAuthProvider,
    signInWithPopup
  } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

  // TODO: paste your real config here
  const firebaseConfig = {
    apiKey: "AIzaSyB045CFqlXmsjYyOzT8EUywKDzEFgiGHRM",
    authDomain: "minecraft-tournament-lifeline.firebaseapp.com",
    projectId: "minecraft-tournament-lifeline",
    appId: "1:24736255993:web:50f0d2ebcc1e8b2efa3728",
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // DOM shortcuts
  const $ = (id)=>document.getElementById(id);
  const emailForm = $('emailForm');
  const emailError = $('emailError');

  // Hide the OTP/password step since we use email-link flow
  const stepVerify = $('stepVerify');
  if (stepVerify) stepVerify.hidden = true;

  // Google sign-up
  $('btnGoogle').addEventListener('click', async ()=>{
    try {
      const provider = new GoogleAuthProvider();
      await signInWithPopup(auth, provider);
      // success → go to your app
      window.location.href = 'login.htm'; // or dashboard.htm
    } catch (e) {
      alert('Google sign-in failed: ' + e.message);
    }
  });

  // Apple button left as-is; needs Apple Developer setup + Firebase provider
  $('btnApple').addEventListener('click', ()=>{
    alert('Apple sign-in needs configuration in Apple Developer + Firebase.');
  });

  // Email link (passwordless) sign-up
  const actionCodeSettings = {
    url: window.location.origin + '/login.htm', // after clicking email link, user returns here
    handleCodeInApp: true
  };

  emailForm.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const email = $('email').value.trim();
    if(!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){
      emailError.style.display = 'block';
      return;
    }
    emailError.style.display = 'none';

    try {
      await sendSignInLinkToEmail(auth, email, actionCodeSettings);
      localStorage.setItem('lifeline_email_for_signin', email);
      alert('We sent you a sign-in link. Check your inbox.');
      // Optionally, change the UI to show a “Check your email” message.
    } catch (err) {
      alert('Could not send link: ' + err.message);
    }
  });

  // Footer year
  $('year').textContent = new Date().getFullYear();
</script>

</body>
</html>

